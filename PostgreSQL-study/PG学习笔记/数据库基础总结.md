# 数据库基础总结

https://zhuanlan.zhihu.com/p/67860548

[![李则果](https://pic1.zhimg.com/v2-04f266efbb49f6b80da22cbad71f71ea_xs.jpg?source=172ae18b)](https://www.zhihu.com/people/li_biubiu)

[李则果](https://www.zhihu.com/people/li_biubiu)

java/Django后端

关注他

17 人赞同了该文章

## 一、数据库的管理发展阶段

1. 人工管理（20世纪50年代中期以前）

- 计算机系统不提供对用户数据的管理功能
- 数据不能共享
- 不单独保存数据

1. 文件系统（20世纪50年代后期到60年代中期）

特点:

- 数据以“文件”形式可长期保存在外部存储器的磁盘上
- 数据的逻辑结构与物理结构有了区别，但比较简单
- 文件组织已多样化
- 数据不再属于某个特定的程序，可以重复使用，即数据面向应用
- 对数据的操作以记录为单位

缺陷：

- 数据冗余
- 不一致性
- 数据联系弱

1. 数据库管理系统（60年代后期）

- 采用数据模型表示复杂的数据结构
- 有较高的数据独立性
- 数据库系统为用户提供了方便的用户接口
- 数据库系统提供了数据控制功能
- 增加了系统的灵活性

## 二、模型

模型是对事务、对象、过程等客观系统中感兴趣的内容的模拟和抽象表达，是理解系统的思维工具。

## 三、数据模型

数据模型也是一种模型，它是对现实世界数据特征的抽象。

数据模型分为两大类：概念模型、组织层数据模型也称组织模型。

组织模型分为：层次模型（用树形结构组织数据）、网状模型（用图形结构组织数据）、关系模型（用简单二维表结构组织数据）、对象-关系模型（用复杂的表格以及其他组织结构组织数据）。

## 四、概念模型

抽象现实系统中有应用价值的元素及其关联关系，反应现实系统中有应用价值的信息结构，并且不依赖于数据的组织层数据模型。

常用的概念模型有E-R模型、语言对象模型。

实体-联系模型：即E-R图（Entity-Relationship)

1、实体：实体是具有公共性质并可相互区分的现实世界对象的集合，如职工、学生、教师、课程。

2、属性：每个实体都具有一定的特征和性质，用来区别实体，如学生的学号、姓名、性别、出生年月。

3、联系：实体内部与实体之间的联系，实体内部联系常常指属性之间的联系，实体之间的联系指不同实体之间的联系

实体之间的联系分为3类：

- 一对一联系（1：1），如部门与经理，一个部门只能有一个经理，一个经理对应一个部门。
- 一对多联系（1：n），如院系与学生，多个学生属于一个院系，一个院系对应多个学生。
- 多对多联系（n：n) ，如选课与学生，一个学生可以选多门课，一门课也可以被多个学生选。

## 五、模式

模式是用给定的数据模型描述具体的数据，ANSI/SPARC体系结构将数据库划分为三层结构：即内模式、概念模式、外模式。

内模式：最接近物理存储，也就是数据的物理存储方式。

外模式：最接近用户，也就是用户所看到的数据视图。

概念模式：介于内模式与外模式之间的中间层次，也称模式。

## 六、两级映像

数据库的三级模式是对数据的三个抽象类别，数据的具体组织留给DBMS，数据库管理系统在三个模式之间提供了以下两级映像：

- 外模式/模式映像。
- 模式/内模式映像。

逻辑独立性：当模式发生变化时（比如增加新的关系、对某个关系增加新的属性、改变属性的数据类型等），可由数据库管理员用外模式定义语句，调用外模式到模式的映像，从而保持外模式不变。由于应用程序一般是依据数据的外模式编写的，因此不必修改应用程序，从而保证了程序与数据的逻辑独立性。

逻辑对立性：当数据库的物理存储改变了，比如选择了另一个存储位置，只需要对模式/内模式映像做相应的调整，就可以保持模式不变，从而不必改变应用程序。因此，保证了数据与程序的物理独立性。

## 七、主键、外键

在介绍主外键之前，先的知道关系数据模型的数据完整性约束，我们现在学习的就是一个关系模型，数据完整性约束分为三大类：**实体完整性、参照完整性、用户自定义完整系**。

1、**实体完整性**：一个数据库由多个表组成，这个表就是一个实体，如Student表，这个表就必须有主码（也即主键），主键相当于人的身份证，可以唯一标识这个人，每个实体也必须有主键，主键可以是一个属性，如学号，也可以是一组属性集，如SC表的（学号，课程号）。

2、**参照完整性**：参照完整性是描述实体与实体之间的联系的，如Student表的学号和SC表（学生选课关系表）中的学号是一个参照，即SC表的Sno是Student的外键。

3、**用户自定义完整性**：用户自定义完整性也称为域完整性或者语义完整性。例如关系属性中的取值范围，用用户自己定义。

**主键：主键也称为主码或主关键字，是关系中用于唯一确定一个元组的一个属性或最小的属性组。**

**外键:如果公共关键字在一个关系中是主关键字，那么这个公共关键字被称为另一个关系的外键。**由此可见，外键表示了两个关系之间的相关联系。以另一个关系的外键作主关键字的表被称为主表，具有此外键的表被称为主表的从表。外键又称作外关键字。

**八、函数依赖**

注：关于具体的术语见何玉洁第四版《数据库原理与应用教程》第95页。

设有关系模式R(A1,A2,...,An),比如SC(Sno,Sname,Cno,Credit,Grade)是一个关系模式，设X,Y是这个关系模式的子集。

非平凡依赖：X->Y,但Y不包含于X，则称X->Y是非平凡依赖项，X是决定因子。未说明，一般讨论非平凡依赖项。

完全函数依赖：如(Sno,Cno)->Grade学号和课程号完全决定成绩，缺一不可，但也不多其他的因子，这种称成绩完全依赖学号和课程号。

部分函数依赖：如（Sno,Cno)->Sname,学号和课程号当然可以决定姓名，但发现仅凭学号也可以决定姓名，我们称Sname部分依赖(Sno,Cno)。

候选码：候选码是指在一个关系中所有的属性完全依赖某一个属性或属性组的属性或属性组的集合，而主码（或主键）也就是在候选码中任意选取的合适的属性或属性组。

全码：候选码为整个属性组。

**九、范式、1NF、2NF、3NF**

关系数据库的关系（关系可以理解为就是一张表）要满足一定的要求，满足不同的要求称为不同的范式。

第一范式：即1NF，不包含重复组的关系（即不包含非原子项的属性）是第一范式的关系。

所有的关系数据库的表都满足第一范式，即这个表就是一个标准的二维表，不存在一个属性列包含2列值，也不存在两个相同的属性列。

第二范式：即2NF，首先要属于第一范式，非主属性完全依赖主属性，不存在非主属性对主属性的部分函数依赖。如Student(Sno,Sname,Sex),非主属性为Sname,Sex，主属性为Sno,而Sname,Sex完全依赖于Sno。

第三范式：即3NF,首先要属于第二范式，并且所有的非主属性都不传递依赖于主码。如学生-住宿关系表中SL(Sno,Sname,Ssex,Sdept,Sloc),假如这个系的学生都被分配在属于这个系的宿舍，即我们只要知道Sdept，就知道Sloc，就有Sno->Sdept,Sdept->Sloc,因此就有Sno->Sloc存在传递性依赖。

理解这三个范式是基础，且在企业中一般只要求做到第二范式就可。

书上对这个的考察方式是给你一个关系，把这个关系根据要求修改为不同的范式。如何玉洁第四版《数据库原理与应用教程》第101页的第6题为常考题型。

**十、事务**

事务：是用户定义的操作系列，这些操作可以作为一个完整的工作单元，事务中的语句作为一个整体，要么全部执行，要么都不执行。

不同的事务处理模型中，事务的开始标记不同，但结束的标记都相同，事务的结束标记有两个：1、正常结束：commit,2、异常结束标记：rollback(回滚），执行的事务中的语句被全部撤销。

**事务的特征（即ACID)**

- 原子性：即事务是数据库的逻辑工作单位，要么全做，要么不做。
- 一致性：即事务执行的结果必须是使数据库从一个一致性状态变到另一个一致性状态。
- 隔离性：事务的执行不能被其他事务干扰。
- 持久性：即一旦事务提交，对数据库的改变时永久性的，以后的操作或故障不会对事务的操作结果产生影响。

具体的SQL事务处理模型见何玉洁第四版《数据库原理与应用教程》第105页。

**并发操作**带来的数据不一致性情况可大致分为4种：

1. 丢失数据修改
2. 读“脏”数据
3. 不可重发读
4. 产生幽灵数据

并发控制的措施：

1. 共享锁
2. 排他锁

具体解释见何玉洁第四版《数据库原理与应用教程》第108页。

封锁协议：

一级封锁协议：对事物要修改的数据加X锁，知道事务结束时才释放

- 防丢失修改。

二级封锁协议：一级封锁协议加上事务T对要读取的数据加S锁，读完后即释放S锁。

- 防丢失修改
- 防止读“脏”数据

三级封锁协议：一级封锁协议加上事务T对要读取的数据加S锁，并直到事务T结束才释放。

- 防丢失修改
- 防止读“脏”数据
- 防不可重复读

**特殊：死锁**

死锁是指两个或两个以上的进程在执行过程中，由于竞争资源或者由于彼此通信而造成的一种阻塞的现象，若无外力作用，它们都将无法推进下去。此时称系统处于死锁状态或系统产生了死锁，这些永远在互相等待的进程称为死锁进程。

**并发调度的可串行性：保证并发操作的正确性**

两段锁协议（2PL)，是保证并发调度的可串行性的封锁协议，具体内容如下：

- 在对任何数据进行读写操作之前，首先要获得对该数据的封锁。
- 在释放一个封锁之后，事务不再申请何获得任何其他锁。

具体内容见何玉洁第四版《数据库原理与应用教程》第113页。

## 十一、数据库备份与恢复

数据库故障的种类见何玉洁第四版《数据库原理与应用教程》第113页。

数据备份：数据备份是指不定期或定期地对数据库进行复制，可以将数据复制到本地机器上，也可以复制到其他机器上。

数据库备份的方式：

- 完全备份：备份全部选中的文件夹，并不依赖文件的存档属性来确定备份那些文件。
- 差异备份：备份自上一次完全备份之后有变化的数据。
- 事务日志备份:指对数据库发生的事务进行备份，包括从上次进行事务日志备份，差异数据备份，完全备份之后，所有已完成的事务。

数据库备份的具体操作见何玉洁第四版《数据库原理与应用教程》第219页。

## 十二、视图

视图是从数据库的基本表中选取出来的数据组成的逻辑窗口。具体的视图定义语句见见何玉洁第四版《数据库原理与应用教程》第87页。

视图的优点：

- 第一点： 使用视图，可以定制用户数据，聚焦特定的数据。

解释： 在实际过程中，公司有不同角色的工作人员，我们以销售公司为例的话， 采购人员，可以需要一些与其有关的数据，而与他无关的数据，对他没 有任何意义，我们可以根据这一实际情况，专门为采购人员创建一个视 图，以后他在查询数据时，只需select * from view_caigou 就可以啦。

- 第二点：使用视图，可以简化数据操作。

解释：我们在使用查询时，在很多时候我们要使用聚合函数，同时还要 显示其它字段的信息，可能还会需要关联到其它表，这时写的语句可能 会很长，如果这个动作频繁发生的话，我们可以创建视图，这以后，我 们只需要select * from view1就可以啦，这样很方便。

- 第三点：使用视图，基表中的数据就有了一定的安全性

因为视图是虚拟的，物理上是不存在的，只是存储了数据的集合，我们可以 将基表中重要的字段信息，可以不通过视图给用户，视图是动态的数据的集 合，数据是随着基表的更新而更新。同时，用户对视图，不可以随意的更改和删除，可以保证数据的安全性。

- 第四点：可以合并分离的数据，创建分区视图

随着社会的发展，公司的业务量的不断的扩大，一个大公司，下属都设有很 多的分公司，为了管理方便，我们需要统一表的结构，定期查看各公司业务 情况，而分别看各个公司的数据很不方便，没有很好的可比性，如果将这些 数据合并为一个表格里，就方便多啦，这时我们就可以使用union关键字， 将各分公司的数据合并为一个视图。

## 十三、触发器

触发器（trigger）是SQL server 提供给程序员和数据分析员来保证数据完整性的一种方法，它是与表事件相关的特殊的存储过程，它的执行不是由程序调用，也不是手工启动，而是由事件来触发，比如当对一个表进行操作（ insert，delete， update）时就会激活它执行。触发器经常用于加强数据的完整性约束和业务规则等。

关于如何使用触发器见[https://blog.csdn.net/weixin_39941298/article/details/81080353](https://link.zhihu.com/?target=https%3A//blog.csdn.net/weixin_39941298/article/details/81080353)

## 十四、存储过程

存储过程（Stored Procedure）是在大型[数据库系统](https://link.zhihu.com/?target=https%3A//baike.baidu.com/item/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F)中，一组为了完成特定功能的SQL 语句集，它存储在数据库中，一次编译后永久有效，用户通过指定存储过程的名字并给出参数（如果该存储过程带有参数）来执行它。存储过程是数据库中的一个重要对象。

相关内容见：[存储过程_百度百科](https://link.zhihu.com/?target=https%3A//baike.baidu.com/item/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B/1240317%3Ffr%3Daladdin)

## 十五、通用数据访问接口

1、ODBC（开放数据连接,Open DataBase Connectivity）

2、JDBC（Java DataBase Connectivity standard）

相关内容见：何玉洁第四版《数据库原理与应用教程》第245页。



## 十六、数据仓库何数据挖掘

作为决策支持系统的辅助支持，数据仓库系统包括三大部分内容：

1. 数据仓库技术
2. 联机分析处理（On-Line Analytics Processing,**OLAP**)技术。
3. 数据挖掘技术

联机分析处理（On-Line Analytics Processing,**OLAP**)技术：联机分析处理（OLAP）系统是数据仓库系统最主要的应用，专门设计用于支持复杂的分析操作，侧重对决策人员和高层管理人员的决策支持，可以根据分析人员的要求快速、灵活地进行大数据量的复杂查询处理，并且以一种直观而易懂的形式将查询结果提供给决策人员，以便他们准确掌握企业（公司）的经营状况，了解对象的需求，制定正确的方案。

OLTP系统（On-Line Transaction Processing[联机事务处理](https://link.zhihu.com/?target=https%3A//baike.baidu.com/item/%E8%81%94%E6%9C%BA%E4%BA%8B%E5%8A%A1%E5%A4%84%E7%90%86)过程(OLTP)）：也称为面向交易的处理过程，其基本特征是前台接收的用户数据可以立即传送到计算中心进行处理，并在很短的时间内给出处理结果，是对用户操作快速响应的方式之一。

ODBC:ODBC是访问数据库的一个工业标准，它支持访问大多数流行数据库的程序中的数据。

DML(data manipulation language):数据操纵语言是SQL语言中，负责对数据库对象运行数据访问工作的指令集，以INSERT、UPDATE、DELETE三种指令为核心，分别代表插入、更新与删除，是开发以数据为中心的应用程序必定会使用到的指令，因此有很多开发人员都把加上SQL的SELECT语句的四大指令以“CRUD”来称呼。

DDL：数据库模式定义语言DDL(Data Definition Language)，是用于描述数据库中要存储的现实世界实体的语言。具体区别见：[https://blog.csdn.net/weixin_39703170/article/details/79011704](https://link.zhihu.com/?target=https%3A//blog.csdn.net/weixin_39703170/article/details/79011704)

数据类型：相关内容见相关内容见：何玉洁第四版《数据库原理与应用教程》第245页。第33页。

数据管理方式：人工管理、文件系统管理、数据库管理。（前面讲过）



**十七、基础与综合应用**

主要从数据的增删改查基础做起，了解如何创建数据库，如何创建表，如何对表进行增删改查（CRUD),具体方法是将何玉洁第四版《数据库原理与应用教程》第3章和第4章的例子敲一遍，我就不搬了。